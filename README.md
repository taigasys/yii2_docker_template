# Универсальная docker-обвязка для Yii2-проектов

Проект состоит из 3 глобальных директорий:
* docker (здесь хранится конфигурация всех контейнеров)
* app (в этой папке вы инициализируете новый Yii2-проект или перемещаете сюда старый)
* mysql (создается автоматически при первом запуске проекта)
* templates (папка с шаблонами, которые при автоматической инициализации раскидываются по правильным папкам)


### Установка

* склонируйте этот репозиторий
* удалите папку .git в корне проекта
* инициализируйте проект с помощью скрипта `./app_init.sh`
* выполните `docker-compose build` (**обязательный шаг** Если пропустить этот шаг то возможна неправильная линковка контейнеров к портам)
* для запуска проекта выполни команду `docker-compose up`

### Запуск и остановка
* Для запуска выполните в корне проекта команду `docker-compose up` или `docker-compose up -d` для запуска в фоновом режиме 
* Для остановки выполните в корне проекта команду `docker-compose stop`
* Для просмотра запущенных контейнеров `docker-compose ps`
* Для подключения к контейнеру с именем `container_name` выполните команду `docker exec -it container_name bash`  

### Обновление
Скрипт `tempaltes\update.sh` нужен, чтобы стянуть с удаленного репозитория обновления и накатить новые миграции.

### Состав контейнеров
* {project_name}_caddy - контейнер с Caddy-сервером
* {project_name}_mysql_db - контейнер с Mysql 5.7
* {project_name}_php - контейнер с php 7.*
* {project_name}_phpmyadmin - PhpMyAdmin для администрирования БД